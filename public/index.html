<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025ë…„ ì„œë¶ê¶Œ ì²­ì†Œë…„ ì¶•ì œ [ë°©ëª…ë¡ ë“±ë¡]</title>
    <style>
        body { font-family: sans-serif; max-width: 500px; margin: 2rem auto; padding: 1rem; }
        form { display: flex; flex-direction: column; gap: 0.8rem; }
        input, select, button { padding: 0.8rem; font-size: 1rem; }
        button { background-color: #007bff; color: white; border: none; cursor: pointer; }
        #result { margin-top: 1rem; padding: 1rem; background-color: #f0f0f0; }
    </style>
</head>
<body>
    <h1> 2025ë…„ ì„œë¶ê¶Œ ì²­ì†Œë…„ ì¶•ì œ ì…ì¥ ë“±ë¡</h1>
    <form id="registerForm">
        <input type="text" id="name" placeholder="ì´ë¦„" required>
        <input type="text" id="number" placeholder="ì—°ë½ì²˜" required>        
        <select id="gender" required>
            <option value="">ì„±ë³„ ì„ íƒ</option>
            <option value="ë‚¨ì„±">ë‚¨ì„±</option>
            <option value="ì—¬ì„±">ì—¬ì„±</option>
        </select>
        <select id="age_group" required>
            <option value="">ì—°ë ¹ëŒ€ ì„ íƒ</option>
            <option value="ìœ ì•„">7ì„¸ì´í•˜</option>            
            <option value="ì´ˆë“±">8~13(ì´ˆë“±)</option>
            <option value="ì¤‘ë“±">14~16(ì¤‘ë“±)</option>    
            <option value="ê³ ë“±">17~19(ê³ ë“±))</option>
            <option value="ëŒ€í•™">20~24(ëŒ€í•™))</option>
            <option value="ì„±ì¸">25ì„¸ ì´ìƒ</option>
        </select>
        <input type="text" id="region" placeholder="ê±°ì£¼ ì§€ì—­ (ì˜ˆ: ë§ˆí¬êµ¬)" required>
        <button type="submit">ë“±ë¡í•˜ê¸°</button>
    </form>
    <div id="result"></div>

    <script>
const form = document.getElementById('registerForm');
const resultDiv = document.getElementById('result');

// ğŸš¨ ë³¸ì¸ì˜ Render ì„œë²„ ì£¼ì†Œë¡œ ë°˜ë“œì‹œ ë³€ê²½í•´ì£¼ì„¸ìš”!
const API_URL = 'https://festival-backend-zika.onrender.com';

form.addEventListener('submit', async (event) => {
    // 1. í¼ì˜ ê¸°ë³¸ ë™ì‘(í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨)ì„ ë§‰ìŠµë‹ˆë‹¤.
    event.preventDefault(); 

    // 2. í¼ì— ì…ë ¥ëœ ê°’ë“¤ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
    const visitorData = {
        name: document.getElementById('name').value,
        number: document.getElementById('number').value, // ì—°ë½ì²˜ ì¶”ê°€
        gender: document.getElementById('gender').value,
        age_group: document.getElementById('age_group').value,
        region: document.getElementById('region').value
    };

    resultDiv.textContent = 'ë“±ë¡ ì¤‘...';

    try {
        // 3. fetch APIë¥¼ ì‚¬ìš©í•´ ì„œë²„ì— POST ìš”ì²­ì„ ë³´ëƒ…ë‹ˆë‹¤.
        const response = await fetch(`${API_URL}/register`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(visitorData)
        });

        // ì„œë²„ì—ì„œ ì—ëŸ¬ ì‘ë‹µì´ ì˜¨ ê²½ìš°
        if (!response.ok) {
            throw new Error('ì„œë²„ ì‘ë‹µì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }

        // 4. ì„œë²„ë¡œë¶€í„° ì„±ê³µ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤.
        const registeredVisitor = await response.json();

        // 5. ê²°ê³¼ ë©”ì‹œì§€ë¥¼ í™”ë©´ì— ë³´ì—¬ì¤ë‹ˆë‹¤.
        resultDiv.textContent = `âœ… ë“±ë¡ ì™„ë£Œ! [${registeredVisitor.id}] ${registeredVisitor.name}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤.`;
        
        form.reset(); // ì…ë ¥ í¼ì„ ê¹¨ë—í•˜ê²Œ ë¹„ì›ë‹ˆë‹¤.

    } catch (error) {
        // 6. ìš”ì²­ ì¤‘ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš° ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
        resultDiv.textContent = `âŒ ë“±ë¡ ì‹¤íŒ¨: ${error.message}`;
    }
});
    </script>
</body>
</html>